---
import About from '../components/home/About.astro';
import Cta from '../components/home/Cta.astro';
import Expertise from '../components/home/Expertise.astro';
import Hero from '../components/home/Hero.astro';
import Trust from '../components/home/Trust.astro';
import Services from '../components/home/Services.astro';
import Testimonials from '../components/home/Testimonials.astro';
import Layout from '../layouts/Layout.astro';
import { useTranslations } from '../i18n/ui';

const lang = 'es';
const t = useTranslations(lang);
---

<Layout
  description={t('home.description')}
  title={t('home.page.title')}
>
  <script slot="head" is:inline>
    (function () {
      if (typeof window === 'undefined') {
        return;
      }

      var path = window.location.pathname;
      if (path !== '/' && path !== '/index.html') {
        return;
      }

      var storedPreference = null;
      try {
        storedPreference = sessionStorage.getItem('preferredLanguage');
      } catch (error) {
        storedPreference = null;
      }

      if (!storedPreference) {
        try {
          storedPreference = localStorage.getItem('preferredLanguage');
        } catch (error) {
          storedPreference = null;
        }
      }

      var browserLang = (navigator.languages && navigator.languages[0]) || navigator.language || navigator.userLanguage || '';
      var targetLang = (storedPreference || browserLang).toLowerCase();

      if (targetLang.startsWith('en')) {
        document.documentElement.style.opacity = '0';
        window.location.replace('/en/');
      }
    })();
  </script>


  <Hero />
  <Trust />
  <Services />
  <Expertise />
  <About />
  <Testimonials />
  <Cta />
</Layout>
