---
import { getLangFromUrl, useTranslations, getLocalizedPath } from '../../i18n/ui';
const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const individualSessions = [
  {
    name: t('pricing.individual.title'),
    description: t('pricing.first.description'),
    price: '79€',
    action: t('pricing.action.book'),
    eventType: 'first-visit',
    features: [
      t('pricing.first.features.0'),
      t('pricing.first.features.1'),
      t('pricing.first.features.2'),
      t('pricing.first.features.3'),
    ],
  },
  {
    name: t('pricing.individual.second'),
    description: t('pricing.second.description'),
    price: '59€',
    action: t('pricing.action.book'),
    eventType: 'second-visit',
    features: [
      t('pricing.second.features.0'),
      t('pricing.second.features.1'),
      t('pricing.second.features.2'),
      t('pricing.second.features.3'),
    ],
  },
  {
    name: t('pricing.individual.followup'),
    description: t('pricing.followup.description'),
    price: '59€',
    action: t('pricing.action.book'),
    eventType: 'followup',
    features: [
      t('pricing.followup.features.0'),
      t('pricing.followup.features.1'),
      t('pricing.followup.features.2'),
      t('pricing.followup.features.3'),
    ],
  },
];

const packages = [
  {
    name: t('pricing.package.roots'),
    description: t('pricing.roots.description'),
    isFlagged: true,
    originalPrice: '197€',
    price: '177€',
    action: t('pricing.action.purchase'),
    eventType: 'roots-package',
    features: [
      t('pricing.roots.features.0'),
      t('pricing.roots.features.1'),
      t('pricing.roots.features.2'),
    ],
    popular: false,
  },
  {
    name: t('pricing.package.circle'),
    description: t('pricing.circle.description'),
    isFlagged: true,
    originalPrice: '315€',
    price: '275€',
    action: t('pricing.action.purchase'),
    eventType: 'circle-package',
    features: [
      t('pricing.circle.features.0'),
      t('pricing.circle.features.1'),
      t('pricing.circle.features.2'),
    ],
    popular: true,
  },
  {
    name: t('pricing.package.nourish'),
    description: t('pricing.nourish.description'),
    isFlagged: true,
    originalPrice: '492€',
    price: '422€',
    action: t('pricing.action.purchase'),
    eventType: 'nourish-package',
    features: [
      t('pricing.nourish.features.0'),
      t('pricing.nourish.features.1'),
      t('pricing.nourish.features.2'),
    ],
    popular: false,
  },
];
---

<section class="py-16 sm:py-20 bg-white">
  <div class="mx-auto max-w-2xl px-4 sm:px-6 lg:max-w-7xl lg:px-8">
    <!-- Individual Sessions -->
    <div class="mb-20">
      <div class="text-center mb-10">
        <span class="inline-flex items-center gap-2 rounded-full bg-brand-blush/50 px-4 py-1.5 text-sm font-medium text-brand-rose mb-4">
          {lang === 'en' ? 'Individual Sessions' : 'Sesiones Individuales'}
        </span>
        <h2 class="font-serif text-2xl sm:text-3xl text-brand-black">{t('pricing.sections.individual')}</h2>
      </div>
      
      <div class="grid gap-6 lg:grid-cols-3">
        {
          individualSessions.map((item) => (
            <div class="relative flex flex-col gap-6 p-6 sm:p-8 bg-brand-ivory rounded-2xl border border-brand-gray/10 hover:shadow-lg transition-all duration-300">
              <div class="flex-1">
                <h3 class="font-serif text-xl text-brand-black">{item.name}</h3>
                <p class="mt-4 flex items-baseline gap-1">
                  <span class="font-serif text-4xl text-brand-accent">{item.price}</span>
                  <span class="text-brand-muted text-sm">/ {lang === 'en' ? 'session' : 'sesión'}</span>
                </p>
                <p class="text-brand-muted mt-4 leading-relaxed">{item.description}</p>

                <ul role="list" class="mt-6 space-y-3">
                  {item.features.map((feature) => (
                    <li class="flex gap-3 items-start">
                      <svg
                        class="text-brand-accent h-5 w-5 flex-shrink-0 mt-0.5"
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        aria-hidden="true"
                      >
                        <path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM11.0026 16L18.0737 8.92893L16.6595 7.51472L11.0026 13.1716L8.17421 10.3431L6.75999 11.7574L11.0026 16Z" />
                      </svg>
                      <span class="text-brand-muted text-sm">{feature}</span>
                    </li>
                  ))}
                </ul>
              </div>
              <a
                href={`${getLocalizedPath('/booking', lang)}?type=${item.eventType}`}
                class="inline-flex w-full items-center justify-center rounded-full border-2 border-brand-accent bg-transparent px-6 py-3 text-base font-medium text-brand-accent transition hover:bg-brand-accent hover:text-white focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-brand-accent"
              >
                {item.action}
              </a>
            </div>
          ))
        }
      </div>
    </div>
    
    <!-- Packages/Bonos -->
    <div>
      <div class="text-center mb-10">
        <span class="inline-flex items-center gap-2 rounded-full bg-brand-accent/10 px-4 py-1.5 text-sm font-medium text-brand-accent mb-4">
          {lang === 'en' ? 'Save More' : 'Ahorra Más'}
        </span>
        <h2 class="font-serif text-2xl sm:text-3xl text-brand-black">{t('pricing.sections.packages')}</h2>
      </div>
      
      <div class="grid gap-6 lg:grid-cols-3">
        {
          packages.map((item) => (
            <div class={`relative flex flex-col gap-6 p-6 sm:p-8 rounded-2xl transition-all duration-300 hover:shadow-xl ${item.popular ? 'bg-brand-accent text-white ring-4 ring-brand-accent/20 scale-[1.02]' : 'bg-white border border-brand-gray/10 hover:shadow-lg'}`}>
              {item.popular && (
                <div class="absolute -top-3 left-1/2 -translate-x-1/2">
                  <span class="inline-flex items-center rounded-full bg-brand-rose px-4 py-1 text-xs font-semibold text-white">
                    {lang === 'en' ? 'Most Popular' : 'Más Popular'}
                  </span>
                </div>
              )}
              
              <div class="flex-1">
                <h3 class={`font-serif text-xl ${item.popular ? 'text-white' : 'text-brand-black'}`}>{item.name}</h3>
                <p class="mt-4 flex flex-col">
                  <span class={`text-sm line-through ${item.popular ? 'text-white/60' : 'text-brand-gray'}`}>{item.originalPrice}</span>
                  <span class={`font-serif text-4xl ${item.popular ? 'text-white' : 'text-brand-accent'}`}>{item.price}</span>
                </p>
                <p class={`mt-4 leading-relaxed ${item.popular ? 'text-white/80' : 'text-brand-muted'}`}>{item.description}</p>

                <ul role="list" class="mt-6 space-y-3">
                  {item.features.map((feature) => (
                    <li class="flex gap-3 items-start">
                      <svg
                        class={`h-5 w-5 flex-shrink-0 mt-0.5 ${item.popular ? 'text-white' : 'text-brand-accent'}`}
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 24 24"
                        fill="currentColor"
                        aria-hidden="true"
                      >
                        <path d="M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22ZM11.0026 16L18.0737 8.92893L16.6595 7.51472L11.0026 13.1716L8.17421 10.3431L6.75999 11.7574L11.0026 16Z" />
                      </svg>
                      <span class={`text-sm font-medium ${item.popular ? 'text-white' : 'text-brand-black'}`}>{feature}</span>
                    </li>
                  ))}
                </ul>
              </div>
              <a
                href={`${getLocalizedPath('/booking', lang)}?type=${item.eventType}`}
                class={`inline-flex w-full items-center justify-center rounded-full px-6 py-3 text-base font-medium transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 ${item.popular ? 'bg-white text-brand-accent hover:bg-brand-ivory focus-visible:outline-white' : 'bg-brand-accent text-white hover:bg-brand-accent/90 focus-visible:outline-brand-accent'}`}
              >
                {item.action}
              </a>
            </div>
          ))
        }
      </div>
    </div>
  </div>
</section>
